# Rosatom Good Deeds API

Backend API –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å–∫–∏—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤ –∏ –ù–ö–û "–≠–Ω–µ—Ä–≥–∏—è –¥–æ–±—Ä—ã—Ö –¥–µ–ª".

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

### Backend
- **FastAPI** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API
- **Python 3.11+** - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **SQLAlchemy** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **Alembic** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
- **PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **python-jose** - JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **passlib[bcrypt]** - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **OAuth2** - –ø—Ä–æ—Ç–æ–∫–æ–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- **Pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Uvicorn** - ASGI —Å–µ—Ä–≤–µ—Ä
- **python-multipart** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `gooddeeds_db5` —Å–æ–¥–µ—Ä–∂–∏—Ç 29 —Ç–∞–±–ª–∏—Ü:

### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
- `role` - —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (user, nko_representative, admin)
- `city` - –≥–æ—Ä–æ–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ù–ö–û
- `category_event` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- `category_news` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- `category_knowledge_base_data` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
- `type_event` - —Ç–∏–ø—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π (–æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω)
- `type_social_media` - —Ç–∏–ø—ã —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π
- `type_material_category_knowledge_base_data` - —Ç–∏–ø—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ (–≤–∏–¥–µ–æ/—Å—Ç–∞—Ç—å–∏/–¥–æ–∫—É–º–µ–Ω—Ç—ã)
- `status_organization` - —Å—Ç–∞—Ç—É—Å—ã –ù–ö–û (pending, approved, rejected)
- `status_participant_event` - —Å—Ç–∞—Ç—É—Å—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
- `user` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- `organization` - –ù–ö–û –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- `event` - –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
- `news` - –Ω–æ–≤–æ—Å—Ç–∏
- `knowledge_base_data` - –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π

### –°–≤—è–∑—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- `photo_organization` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- `photo_news` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- `photo_event` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- `social_media_organization` - —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- `file_event` - —Ñ–∞–π–ª—ã –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- `file_news` - —Ñ–∞–π–ª—ã –Ω–æ–≤–æ—Å—Ç–µ–π
- `material_knowledge_base_data` - –º–∞—Ç–µ—Ä–∏–∞–ª—ã –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
- `hashtag_event` - —Ö–µ—à—Ç–µ–≥–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- `hashtags_news` - —Ö–µ—à—Ç–µ–≥–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- `participant_event` - —É—á–∞—Å—Ç–Ω–∏–∫–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π

### –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
- `selected_event` - –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `selected_news` - –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `selected_knowledge_base_data` - –∏–∑–±—Ä–∞–Ω–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ API endpoints

### üîê Authentication (`/auth`)
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `POST /auth/register/user` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞
- `POST /auth/register/nko` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ù–ö–û
- `POST /auth/register/representative` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è –ù–ö–û
- `POST /auth/register/nko-application` - –ø–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏ –ù–ö–û
- `POST /auth/login` - –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

### üë§ Users (`/users`)
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏):
- `GET /users/me` - –ø–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
- `PATCH /users/me/city` - –æ–±–Ω–æ–≤–∏—Ç—å –≥–æ—Ä–æ–¥

### üè¢ NKO (`/nko`)
–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –ù–ö–û (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å nko_representative):
- `GET /nko/profile/me` - –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ù–ö–û
- `PUT /nko/profile/me` - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ù–ö–û
- `POST /nko/profile/me/submit-moderation` - –ø–æ–¥–∞—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
- `POST /nko/profile/me/logo` - –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø
- `POST /nko/posts` - —Å–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç (–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ/–Ω–æ–≤–æ—Å—Ç—å)
- `POST /nko/posts/{post_id}/submit` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Å—Ç –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é

### üë®‚Äçüíº Admin (`/admin`)
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å admin):
- `GET /admin/nkos/pending` - –ù–ö–û –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `POST /admin/nkos/{nko_email}/approve` - –æ–¥–æ–±—Ä–∏—Ç—å –ù–ö–û
- `POST /admin/nkos/{nko_email}/reject` - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –ù–ö–û
- `GET /admin/posts/pending` - –ø–æ—Å—Ç—ã –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `POST /admin/posts/{post_id}/approve` - –æ–¥–æ–±—Ä–∏—Ç—å –ø–æ—Å—Ç
- `POST /admin/posts/{post_id}/reject` - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –ø–æ—Å—Ç
- `GET /admin/users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `PUT /admin/users/{user_email}/role` - –∏–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /admin/users/with-roles` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—è–º–∏

### üåê Public (`/public`)
–ü—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏):

**–ù–æ–≤–æ—Å—Ç–∏:**
- `GET /public/news` - —Å–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π
- `GET /public/news/{news_id}` - –¥–µ—Ç–∞–ª–∏ –Ω–æ–≤–æ—Å—Ç–∏

**–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:**
- `GET /public/events` - —Å–ø–∏—Å–æ–∫ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- `GET /public/events/{event_id}` - –¥–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è

**–ù–ö–û:**
- `GET /public/nkos` - —Å–ø–∏—Å–æ–∫ –ù–ö–û
- `GET /public/nkos/{nko_id}` - –¥–µ—Ç–∞–ª–∏ –ù–ö–û

**–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π:**
- `GET /public/knowledge-base` - —Å–ø–∏—Å–æ–∫ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- `GET /public/knowledge-base/{kb_id}` - –¥–µ—Ç–∞–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞

**–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏:**
- `GET /public/categories/news` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- `GET /public/categories/events` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- `GET /public/categories/nkos` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ù–ö–û

**–§–∞–π–ª—ã:**
- `GET /public/files` - —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤

## Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- **Swagger UI:** http://localhost:8000/docs
- **ReDoc:** http://localhost:8000/redoc

*(–ó–¥–µ—Å—å –±—É–¥—É—Ç —Ä–∞–∑–º–µ—â–µ–Ω—ã —Å–∫—Ä–∏–Ω—à–æ—Ç—ã Swagger –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)*

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:
```env
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=gooddeeds_db5
SECRET_KEY=your-secret-key
```

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
alembic upgrade head
```

4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
```bash
python migrations/migrate_json_to_db.py
```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

1. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
docker-compose up -d
```

2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
docker-compose exec backend alembic upgrade head
```

3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
```bash
docker-compose exec backend python migrations/migrate_json_to_db.py
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Rosatom-Good-Deeds/
‚îú‚îÄ‚îÄ alembic/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ app/                  # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ main.py          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ auth.py          # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ users.py         # API –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ nko.py           # API –ù–ö–û
‚îÇ   ‚îú‚îÄ‚îÄ admin.py         # API –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ public.py        # –ü—É–±–ª–∏—á–Ω—ã–π API
‚îÇ   ‚îú‚îÄ‚îÄ models.py        # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ db_models.py     # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ database.py      # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py  # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ FastAPI
‚îÇ   ‚îî‚îÄ‚îÄ config.py        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ files/               # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ migrations/          # –°–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ static/              # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ Dockerfile           # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml   # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

Apache License 2.0
